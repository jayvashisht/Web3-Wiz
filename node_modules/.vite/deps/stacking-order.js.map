{
  "version": 3,
  "sources": ["../../stacking-order/index.js"],
  "sourcesContent": ["/**\n * Determine which of two nodes appears in front of the other â€”\n * if `a` is in front, returns 1, otherwise returns -1\n * @param {HTMLElement} a\n * @param {HTMLElement} b\n */\nexport function compare(a, b) {\n\tif (a === b) throw new Error('Cannot compare node with itself');\n\n\tconst ancestors = {\n\t\ta: get_ancestors(a),\n\t\tb: get_ancestors(b),\n\t};\n\n\tlet common_ancestor;\n\n\t// remove shared ancestors\n\twhile (ancestors.a.at(-1) === ancestors.b.at(-1)) {\n\t\ta = ancestors.a.pop();\n\t\tb = ancestors.b.pop();\n\n\t\tcommon_ancestor = a;\n\t}\n\n\tconst z_indexes = {\n\t\ta: get_z_index(find_stacking_context(ancestors.a)),\n\t\tb: get_z_index(find_stacking_context(ancestors.b)),\n\t};\n\n\tif (z_indexes.a === z_indexes.b) {\n\t\tconst children = common_ancestor.childNodes;\n\n\t\tconst furthest_ancestors = {\n\t\t\ta: ancestors.a.at(-1),\n\t\t\tb: ancestors.b.at(-1),\n\t\t};\n\n\t\tlet i = children.length;\n\t\twhile (i--) {\n\t\t\tconst child = children[i];\n\t\t\tif (child === furthest_ancestors.a) return 1;\n\t\t\tif (child === furthest_ancestors.b) return -1;\n\t\t}\n\t}\n\n\treturn Math.sign(z_indexes.a - z_indexes.b);\n}\n\nconst props = /\\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\\b/;\n\n/** @param {HTMLElement} node */\nfunction is_flex_item(node) {\n\tconst display = getComputedStyle(get_parent(node)).display;\n\treturn display === 'flex' || display === 'inline-flex';\n}\n\n/** @param {HTMLElement} node */\nfunction creates_stacking_context(node) {\n\tconst style = getComputedStyle(node);\n\n\t// https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Positioning/Understanding_z_index/The_stacking_context\n\tif (style.position === 'fixed') return true;\n\tif ((style.zIndex !== 'auto' && style.position !== 'static') || is_flex_item(node)) return true;\n\tif (+style.opacity < 1) return true;\n\tif ('transform' in style && style.transform !== 'none') return true;\n\tif ('webkitTransform' in style && style.webkitTransform !== 'none') return true;\n\tif ('mixBlendMode' in style && style.mixBlendMode !== 'normal') return true;\n\tif ('filter' in style && style.filter !== 'none') return true;\n\tif ('webkitFilter' in style && style.webkitFilter !== 'none') return true;\n\tif ('isolation' in style && style.isolation === 'isolate') return true;\n\tif (props.test(style.willChange)) return true;\n\t// @ts-expect-error\n\tif (style.webkitOverflowScrolling === 'touch') return true;\n\n\treturn false;\n}\n\n/** @param {HTMLElement[]} nodes */\nfunction find_stacking_context(nodes) {\n\tlet i = nodes.length;\n\n\twhile (i--) {\n\t\tif (creates_stacking_context(nodes[i])) return nodes[i];\n\t}\n\n\treturn null;\n}\n\n/** @param {HTMLElement} node */\nfunction get_z_index(node) {\n\treturn (node && Number(getComputedStyle(node).zIndex)) || 0;\n}\n\n/** @param {HTMLElement} node */\nfunction get_ancestors(node) {\n\tconst ancestors = [];\n\n\twhile (node) {\n\t\tancestors.push(node);\n\t\tnode = get_parent(node);\n\t}\n\n\treturn ancestors; // [ node, ... <body>, <html>, document ]\n}\n\n/** @param {HTMLElement} node */\nfunction get_parent(node) {\n\t// @ts-ignore\n\treturn node.parentNode?.host || node.parentNode;\n}\n"],
  "mappings": ";;;AAMO,SAAS,QAAQ,GAAG,GAAG;AAC7B,MAAI,MAAM;AAAG,UAAM,IAAI,MAAM,iCAAiC;AAE9D,QAAM,YAAY;AAAA,IACjB,GAAG,cAAc,CAAC;AAAA,IAClB,GAAG,cAAc,CAAC;AAAA,EACnB;AAEA,MAAI;AAGJ,SAAO,UAAU,EAAE,GAAG,EAAE,MAAM,UAAU,EAAE,GAAG,EAAE,GAAG;AACjD,QAAI,UAAU,EAAE,IAAI;AACpB,QAAI,UAAU,EAAE,IAAI;AAEpB,sBAAkB;AAAA,EACnB;AAEA,QAAM,YAAY;AAAA,IACjB,GAAG,YAAY,sBAAsB,UAAU,CAAC,CAAC;AAAA,IACjD,GAAG,YAAY,sBAAsB,UAAU,CAAC,CAAC;AAAA,EAClD;AAEA,MAAI,UAAU,MAAM,UAAU,GAAG;AAChC,UAAM,WAAW,gBAAgB;AAEjC,UAAM,qBAAqB;AAAA,MAC1B,GAAG,UAAU,EAAE,GAAG,EAAE;AAAA,MACpB,GAAG,UAAU,EAAE,GAAG,EAAE;AAAA,IACrB;AAEA,QAAI,IAAI,SAAS;AACjB,WAAO,KAAK;AACX,YAAM,QAAQ,SAAS,CAAC;AACxB,UAAI,UAAU,mBAAmB;AAAG,eAAO;AAC3C,UAAI,UAAU,mBAAmB;AAAG,eAAO;AAAA,IAC5C;AAAA,EACD;AAEA,SAAO,KAAK,KAAK,UAAU,IAAI,UAAU,CAAC;AAC3C;AAEA,IAAM,QAAQ;AAGd,SAAS,aAAa,MAAM;AAC3B,QAAM,UAAU,iBAAiB,WAAW,IAAI,CAAC,EAAE;AACnD,SAAO,YAAY,UAAU,YAAY;AAC1C;AAGA,SAAS,yBAAyB,MAAM;AACvC,QAAM,QAAQ,iBAAiB,IAAI;AAGnC,MAAI,MAAM,aAAa;AAAS,WAAO;AACvC,MAAK,MAAM,WAAW,UAAU,MAAM,aAAa,YAAa,aAAa,IAAI;AAAG,WAAO;AAC3F,MAAI,CAAC,MAAM,UAAU;AAAG,WAAO;AAC/B,MAAI,eAAe,SAAS,MAAM,cAAc;AAAQ,WAAO;AAC/D,MAAI,qBAAqB,SAAS,MAAM,oBAAoB;AAAQ,WAAO;AAC3E,MAAI,kBAAkB,SAAS,MAAM,iBAAiB;AAAU,WAAO;AACvE,MAAI,YAAY,SAAS,MAAM,WAAW;AAAQ,WAAO;AACzD,MAAI,kBAAkB,SAAS,MAAM,iBAAiB;AAAQ,WAAO;AACrE,MAAI,eAAe,SAAS,MAAM,cAAc;AAAW,WAAO;AAClE,MAAI,MAAM,KAAK,MAAM,UAAU;AAAG,WAAO;AAEzC,MAAI,MAAM,4BAA4B;AAAS,WAAO;AAEtD,SAAO;AACR;AAGA,SAAS,sBAAsB,OAAO;AACrC,MAAI,IAAI,MAAM;AAEd,SAAO,KAAK;AACX,QAAI,yBAAyB,MAAM,CAAC,CAAC;AAAG,aAAO,MAAM,CAAC;AAAA,EACvD;AAEA,SAAO;AACR;AAGA,SAAS,YAAY,MAAM;AAC1B,SAAQ,QAAQ,OAAO,iBAAiB,IAAI,EAAE,MAAM,KAAM;AAC3D;AAGA,SAAS,cAAc,MAAM;AAC5B,QAAM,YAAY,CAAC;AAEnB,SAAO,MAAM;AACZ,cAAU,KAAK,IAAI;AACnB,WAAO,WAAW,IAAI;AAAA,EACvB;AAEA,SAAO;AACR;AAGA,SAAS,WAAW,MAAM;AA1G1B;AA4GC,WAAO,UAAK,eAAL,mBAAiB,SAAQ,KAAK;AACtC;",
  "names": []
}
